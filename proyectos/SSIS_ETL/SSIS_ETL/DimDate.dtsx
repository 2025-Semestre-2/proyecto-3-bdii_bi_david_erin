<?xml version="1.0"?>
<DTS:Executable xmlns:DTS="www.microsoft.com/SqlServer/Dts"
  DTS:refId="Package"
  DTS:CreationDate="12/4/2025 9:32:18 PM"
  DTS:CreationName="Microsoft.Package"
  DTS:CreatorComputerName="DAVIDNOTEBOOK"
  DTS:CreatorName="DAVIDNOTEBOOK\garci"
  DTS:DTSID="{6BE90912-5DAC-4949-A913-F8055887FE1B}"
  DTS:ExecutableType="Microsoft.Package"
  DTS:LastModifiedProductVersion="16.0.5467.0"
  DTS:LocaleID="5130"
  DTS:ObjectName="Package1"
  DTS:PackageType="5"
  DTS:VersionBuild="7"
  DTS:VersionGUID="{71F475B0-C41B-48F2-A82D-F08F993DEBD9}">
  <DTS:Property
    DTS:Name="PackageFormatVersion">8</DTS:Property>
  <DTS:Variables />
  <DTS:Executables>
    <DTS:Executable
      DTS:refId="Package\CargarDatos"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="Tarea Ejecutar SQL"
      DTS:DTSID="{656DB5E4-34D5-4EF7-9E67-18A5A8723DBD}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="CargarDatos"
      DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2022; © 2022 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{786C4F2E-CD6D-4D97-8A45-62C779F89A91}"
          SQLTask:SqlStatementSource="DECLARE @StartDate DATE = '2016-01-01';&#xA;DECLARE @EndDate   DATE = '2030-12-31';&#xA;DECLARE @current_date DATE = @StartDate;&#xA;&#xA;WHILE @current_date &lt;= @EndDate&#xA;    BEGIN&#xA;        INSERT INTO DimDate (&#xA;            date_key,&#xA;            date,&#xA;            year,&#xA;            year_month,&#xA;            quarter,&#xA;            month,&#xA;            month_name,&#xA;            day,&#xA;            day_of_week,&#xA;            day_name,&#xA;            week,&#xA;            is_weekend,&#xA;            is_holiday,&#xA;            holiday_name&#xA;        )&#xA;        VALUES (&#xA;            CAST(FORMAT(@current_date, 'yyyyMMdd') AS INT),                          -- date_key (ej: 20250107)&#xA;            @current_date,                                                            -- date&#xA;            YEAR(@current_date),                                                      -- year&#xA;            CAST(FORMAT(@current_date, 'yyyyMM') AS INT),                            -- year_month (ej: 202501)&#xA;            DATEPART(QUARTER, @current_date),                                         -- quarter (1-4)&#xA;            MONTH(@current_date),                                                     -- month (1-12)&#xA;            DATENAME(MONTH, @current_date),                                           -- month_name (January, February...)&#xA;            DAY(@current_date),                                                       -- day (1-31)&#xA;            DATEPART(WEEKDAY, @current_date),                                         -- day_of_week (1=Sunday, 7=Saturday)&#xA;            DATENAME(WEEKDAY, @current_date),                                         -- day_name (Sunday, Monday...)&#xA;            DATEPART(WEEK, @current_date),                                            -- week (1-53)&#xA;            CASE WHEN DATEPART(WEEKDAY, @current_date) IN (1, 7) THEN 1 ELSE 0 END,  -- is_weekend&#xA;            0,                                                                        -- is_holiday (default, se actualiza después)&#xA;            NULL                                                                      -- holiday_name (se actualiza después)&#xA;        );&#xA;        &#xA;        SET @current_date = DATEADD(DAY, 1, @current_date);&#xA;    END&#xA;    &#xA;    -- Paso 2: Actualizar feriados de Costa Rica&#xA;    &#xA;    -- Año Nuevo (1 de enero)&#xA;    UPDATE DimDate &#xA;    SET is_holiday = 1, holiday_name = 'Año Nuevo'&#xA;    WHERE month = 1 AND day = 1;&#xA;    &#xA;    -- Día de Juan Santamaría (11 de abril)&#xA;    UPDATE DimDate &#xA;    SET is_holiday = 1, holiday_name = 'Día de Juan Santamaría'&#xA;    WHERE month = 4 AND day = 11;&#xA;    &#xA;    -- Jueves Santo (variable - jueves antes de Semana Santa)&#xA;    -- Viernes Santo (calculado como viernes antes del Domingo de Pascua)&#xA;    -- Nota: Implementación simplificada para Semana Santa&#xA;    UPDATE DimDate &#xA;    SET is_holiday = 1, holiday_name = 'Semana Santa'&#xA;    WHERE month = 4 AND day_name IN ('Thursday', 'Friday') &#xA;      AND day BETWEEN 1 AND 20;  -- Aproximación, Semana Santa suele ser en marzo-abril&#xA;    &#xA;    -- Día del Trabajo (1 de mayo)&#xA;    UPDATE DimDate &#xA;    SET is_holiday = 1, holiday_name = 'Día del Trabajo'&#xA;    WHERE month = 5 AND day = 1;&#xA;    &#xA;    -- Anexión de Guanacaste (25 de julio)&#xA;    UPDATE DimDate &#xA;    SET is_holiday = 1, holiday_name = 'Anexión de Guanacaste'&#xA;    WHERE month = 7 AND day = 25;&#xA;    &#xA;    -- Día de la Madre (15 de agosto)&#xA;    UPDATE DimDate &#xA;    SET is_holiday = 1, holiday_name = 'Día de la Madre'&#xA;    WHERE month = 8 AND day = 15;&#xA;    &#xA;    -- Día de la Independencia (15 de septiembre)&#xA;    UPDATE DimDate &#xA;    SET is_holiday = 1, holiday_name = 'Independencia de Costa Rica'&#xA;    WHERE month = 9 AND day = 15;&#xA;    &#xA;    -- Día de las Culturas (12 de octubre)&#xA;    UPDATE DimDate &#xA;    SET is_holiday = 1, holiday_name = 'Día de las Culturas'&#xA;    WHERE month = 10 AND day = 12;&#xA;&#xA;    -- Día de la Abolición del Ejército (1 de diciembre)&#xA;    UPDATE DimDate &#xA;    SET is_holiday = 1, holiday_name = 'Día de la Abolición del Ejército'&#xA;    WHERE month = 12 AND day = 1;&#xA;    &#xA;    -- Navidad (25 de diciembre)&#xA;    UPDATE DimDate &#xA;    SET is_holiday = 1, holiday_name = 'Navidad'&#xA;    WHERE month = 12 AND day = 25;&#xA;    &#xA;    -- Paso 3: Feriados comerciales importantes para retail&#xA;    &#xA;    -- Día del Padre (tercer domingo de junio)&#xA;    UPDATE d&#xA;    SET is_holiday = 1, holiday_name = 'Día del Padre'&#xA;    FROM DimDate d&#xA;    WHERE month = 6 &#xA;      AND day_of_week = 1  -- Domingo&#xA;      AND day BETWEEN 15 AND 21;  -- Tercer domingo&#xA;    &#xA;    -- Black Friday (último viernes de noviembre)&#xA;    UPDATE d&#xA;    SET is_holiday = 1, holiday_name = 'Black Friday'&#xA;    FROM DimDate d&#xA;    WHERE month = 11 &#xA;      AND day_of_week = 6  -- Viernes&#xA;      AND day &gt;= 23;  -- Último viernes&#xA;    &#xA;    -- Cyber Monday (lunes después de Black Friday)&#xA;    UPDATE d&#xA;    SET is_holiday = 1, holiday_name = 'Cyber Monday'&#xA;    FROM DimDate d&#xA;    WHERE month = 11 &#xA;      AND day_of_week = 2  -- Lunes&#xA;      AND day &gt;= 25;  -- Lunes después del último viernes&#xA;    &#xA;    -- Nochebuena (24 de diciembre)&#xA;    UPDATE DimDate &#xA;    SET is_holiday = 1, holiday_name = 'Nochebuena'&#xA;    WHERE month = 12 AND day = 24;&#xA;    &#xA;    -- Fin de Año (31 de diciembre)&#xA;    UPDATE DimDate &#xA;    SET is_holiday = 1, holiday_name = 'Fin de Año'&#xA;    WHERE month = 12 AND day = 31;&#xA;" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
      </DTS:ObjectData>
    </DTS:Executable>
  </DTS:Executables>
  <DTS:DesignTimeProperties><![CDATA[<?xml version="1.0"?>
<!--Esta sección CDATA contiene la información de diseño del paquete. Esta sección incluye información como, por ejemplo, las coordenadas (x,y), el ancho y el alto.-->
<!--Si edita manualmente esta sección y comete un error, puede eliminarlo. -->
<!--El paquete podrá cargarse normalmente, pero se perderá la información de diseño anterior y el diseñador reorganizará los elementos automáticamente en la superficie de diseño.-->
<Objects
  Version="8">
  <!--Cada uno de los nodos siguientes contiene propiedades que no afectan al comportamiento en tiempo de ejecución.-->
  <Package
    design-time-name="Package">
    <LayoutInfo>
      <GraphLayout
        Capacity="4" xmlns="clr-namespace:Microsoft.SqlServer.IntegrationServices.Designer.Model.Serialization;assembly=Microsoft.SqlServer.IntegrationServices.Graph">
        <NodeLayout
          Size="136.8,41.6"
          Id="Package\CargarDatos"
          TopLeft="442.857150398955,214.117650061743" />
      </GraphLayout>
    </LayoutInfo>
  </Package>
</Objects>]]></DTS:DesignTimeProperties>
</DTS:Executable>